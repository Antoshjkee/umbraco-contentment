<!-- Copyright © 2019 Lee Kelleher, Umbrella Inc and other contributors.
   - This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at https://mozilla.org/MPL/2.0/. -->

<div class="contentment" ng-controller="Our.Umbraco.Contentment.DataEditors.Blocks.Controller as vm">

    <umb-editor-sub-header appearance="white">
        <umb-editor-sub-header-content-right>
            <umb-button type="button"
                        icon="icon-navigation"
                        button-style="link"
                        label-key="general_reorder"
                        action="vm.reorder()">
            </umb-button>
        </umb-editor-sub-header-content-right>
    </umb-editor-sub-header>

    <ul class="umb-group-builder__properties" ui-sortable="vm.sortableOptions" ng-model="model.value">
        <li ng-repeat="item in model.value">
            <div class="umb-group-builder__property">

                <div tabindex="-1" class="umb-group-builder__property-preview">

                    <div class="umb-group-builder__property-tags">
                        <span class="umb-group-builder__property-tag -white">
                            <i class="icon-item-arrangement umb-group-builder__property-tag-icon"></i>
                            <span>{{item.contentTypeName}}</span>
                        </span>
                        <span class="umb-group-builder__property-tag -white">
                            <i class="icon-edit umb-group-builder__property-tag-icon"></i>
                            <span>{{item.name}}</span>
                        </span>
                    </div>

                    <div class="umb-group-builder__property-tags -right"></div>

                    <div class="umb-group-builder__property-preview-form">
                        <!-- Block content goes here -->
                    </div>

                    <button type="button" class="umb-group-builder__open-settings" ng-click="vm.edit(item)"></button>
                </div>

                <div class="umb-group-builder__property-actions">
                    <div>
                        <div class="umb-group-builder__property-action" title="Edit">
                            <button type="button" class="icon icon-settings" ng-click="vm.edit(item)"></button>
                        </div>
                        <!-- TODO: Add copy feature -->
                        <!--<div class="umb-group-builder__property-action" title="Copy">
                            <button type="button" class="icon icon-documents"></button>
                        </div>-->
                        <div class="umb-group-builder__property-action" title="Remove">
                            <button type="button" class="icon-trash" ng-click="vm.showPrompt(item)"></button>
                            <umb-confirm-action ng-if="item.prompt"
                                                direction="left"
                                                on-confirm="vm.remove($index)"
                                                on-cancel="vm.hidePrompt(item)">
                            </umb-confirm-action>
                        </div>
                    </div>
                </div>

            </div>
        </li>
    </ul>

    <a class="umb-node-preview-add" href="" ng-click="vm.add()" ng-if="vm.allowAdd" prevent-default>
        <localize key="general_add">Add</localize>
    </a>

</div>
